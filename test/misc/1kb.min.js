/*!MIT(c)paulmillr.com*/const h=2n**256n,y=h-0x1000003d1n,f=h-0x14551231950b75fc4402da1732fc9bebfn,m=(n="")=>{throw new Error(n)},e=(n,t=y)=>{const o=n%t;return o>=0n?o:t+o},x=(n,t)=>{(n===0n||t<=0n)&&m("no inverse n="+n+" mod="+t);let o=e(n,t),c=t,r=0n,s=1n,u=1n,i=0n;for(;o!==0n;){const a=c/o,l=c%o,v=r-u*a,Y=s-i*a;c=o,o=l,r=u,s=i,u=v,i=Y}return c===1n?e(r,t):m("no inverse")},b=(n,t)=>({x:n,y:t}),w={x:0n,y:0n},P=n=>{const t=n.x,o=n.y,c=e(3n*t**2n*x(2n*o,y)),r=e(c*c-2n*t),s=e(c*(t-r)-o);return b(r,s)},X=(n,t)=>{const o=n.x,c=n.y,r=t.x,s=t.y;if(o===0n||c===0n)return t;if(r===0n||s===0n)return n;if(o===r&&c===s)return P(n);if(o===r&&c===e(-s))return w;const u=e((s-c)*x(r-o,y)),i=e(u*u-o-r),a=e(u*(o-i)-c);return b(i,a)},E=0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,g=0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,_=b(E,g),d=(n,t)=>{let o=b(n.x,n.y),c=w;for(;t>0n;)t&1n&&(c=X(c,o)),o=P(o),t>>=1n;return c},A=n=>d(_,n),p=n=>{const t=Array.from(n).map(o=>o.toString(16).padStart(2,"0")).join("");return t?BigInt("0x"+t):0n},B=()=>{const n=crypto.getRandomValues(new Uint8Array(48));return e(p(n),f-1n)+1n},G=(n,t)=>{const o=p(n),c=t;let r=0n,s=0n,u;do{const i=B(),a=x(i,f);u=d(_,i),r=e(u.x,f),s=e(a*e(o+c*r,f),f)}while(r===0n||s===0n);return s>f>>1n&&(s=e(-s,f)),{r,s}},R=(n,t,o)=>{const c=e(p(t),f),r=x(n.s,f),s=e(c*r,f),u=e(n.r*r,f),i=d(_,s),a=d(o,u),l=X(i,a);return e(l.x,f)===n.r};export { A as _getPublicKey, G as _sign, R as _verify };

